processor 16f877
include <p16f877.inc>
valor1 equ h'21'
valor2 equ h'22'
valor3 equ h'23'
cte1 equ h'ff'
cte2 equ 50h
cte3 equ 60h
 	ORG 0
GOTO INICIO
 	ORG 5
INICIO:
	CLRF PORTA
	BSF STATUS,RP0
 	BCF STATUS,RP1
 	MOVLW H'00'
 	MOVWF TRISB
	MOVLW 06H
	MOVWF ADCON1
	MOVLW 3FH
	MOVWF TRISA
 	BCF STATUS,RP0
	MOVLW B'00000000'
	MOVWF PORTB

	
	
loop1:
	MOVLW h'00'	
	SUBWF PORTA, W
	BTFSC STATUS, Z
	GOTO APAGAR_LEDS

	MOVLW H'01'
	SUBWF PORTA, W
	BTFSC STATUS, Z
	GOTO PRENDER_LEDS

	MOVLW H'02'
	SUBWF PORTA, W
	BTFSC STATUS, Z
	GOTO RIGHT_SHIFT	

	MOVLW H'03'
	SUBWF PORTA, W
	BTFSC STATUS, Z
	GOTO LEFT_SHIFT

	MOVLW H'04'
	SUBWF PORTA, W
	BTFSC STATUS, Z
	GOTO ZIG_ZAG_1

	MOVLW H'05'
	SUBWF PORTA, W
	BTFSC STATUS, Z
	GOTO INTERMITENTE

goto loop1	

PRENDER_LEDS:
	MOVLW B'11111111'
	MOVWF PORTB
	GOTO loop1

APAGAR_LEDS:
	CLRF PORTB
	GOTO loop1

RIGHT_SHIFT:
	MOVLW B'10000000'
	MOVWF PORTB
	BCF STATUS, C
LOOP_RS:
	MOVLW H'00'
	SUBWF PORTB
	BTFSC STATUS, Z
	GOTO RIGHT_SHIFT
	CALL retardo
	MOVLW H'02'
	SUBWF PORTA, W
	BTFSS STATUS, Z
	GOTO loop1
	BCF STATUS, C
	RRF PORTB
	
	goto LOOP_RS

LEFT_SHIFT:
	MOVLW B'00000001'
	MOVWF PORTB
	;BCF STATUS, C
LOOP_LS:
	MOVLW H'00'
	SUBWF PORTB
	BTFSC STATUS, Z
	GOTO LEFT_SHIFT
	CALL retardo
	MOVLW H'03'
	SUBWF PORTA, W
	BTFSS STATUS, Z
	GOTO loop1
	BCF STATUS, C
	RLF PORTB
	goto LOOP_LS

ZIG_ZAG_1:
	MOVLW B'10000000'
	MOVWF PORTB
	BCF STATUS, C
LOOP_ZZ_1:
	MOVLW H'00'
	SUBWF PORTB
	BTFSC STATUS, Z
	GOTO ZIG_ZAG_2
	CALL retardo
	MOVLW H'04'
	SUBWF PORTA, W
	BTFSS STATUS, Z
	GOTO loop1
	BCF STATUS, C
	RRF PORTB
	goto LOOP_ZZ_1

ZIG_ZAG_2:
	MOVLW B'00000001'
	MOVWF PORTB
	;BCF STATUS, C
LOOP_ZZ_2:
	MOVLW H'00'
	SUBWF PORTB
	BTFSC STATUS, Z
	GOTO ZIG_ZAG_1
	CALL retardo
	MOVLW H'04'
	SUBWF PORTA, W
	BTFSS STATUS, Z
	GOTO loop1
	BCF STATUS, C
	RLF PORTB
	goto LOOP_ZZ_2

INTERMITENTE:
	MOVLW H'05'
	SUBWF PORTA, W
	BTFSS STATUS, Z
	GOTO loop1
	
	MOVLW H'FF'
	MOVWF PORTB
	CALL retardo
	CLRF PORTB
	CALL retardo
	goto INTERMITENTE	
	

retardo 
	MOVLW cte1
 	MOVWF valor1
tres 
	MOVLW cte2
	MOVWF valor2
dos 
	MOVLW cte3
	MOVWF valor3
uno 
	DECFSZ valor3
 	GOTO uno
	DECFSZ valor2
	GOTO dos
	DECFSZ valor1
	GOTO tres
	RETURN
	END